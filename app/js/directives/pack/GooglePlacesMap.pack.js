"use strict";pizzaApp.directive("googlePlacesMap",function(e,t,n){var r,i,s,o,u,a=[],f=[],l=!1,c,h;h={lat:49.2827,lng:-123.1207};r=49.2827;i=-123.1207;s=14;return{restrict:"E",replace:!0,scope:{myAddress:"=info"},template:'<div id="googlePlaces" class="user-address-map order-location map-marker-popups full-width"></div>',controller:function(e){function i(e){o=new google.maps.Geocoder;var t={zoom:s,center:e};u=new google.maps.Map(document.getElementById("googlePlaces"),t);c=new google.maps.InfoWindow}function h(e){var n=0,r=0;for(var i in e.results){var s=e.results[i],o=t.getStoreDetails(s).then(function(t){f[t.result.place_id]=t;r++;n===e.results.length&&r===e.results.length&&p(e)});n++}}function p(e){var n=0,r=5;for(var i in e.results){var s=e.results[i],o=f[s.place_id],u=t.getContentString(s,o),a=t.getAddress(o),c=t.getMarkerName(s);d(a,u,c,!1);n++;if(n>r||n===e.results.length){l=!0;break}}}function d(e,t,n){o.geocode({address:e},function(e,n){if(n==google.maps.GeocoderStatus.OK){var r={myContent:t},i=new google.maps.Marker({map:u,draggable:!1,position:e[0].geometry.location,animation:google.maps.Animation.DROP});i.addListener("click",function(){c.setContent(r.myContent);c.open(u,i)});a.push(i);l===!0&&v()}else alert("Geocode was not successful for the following reason: "+n)})}function v(){var e=new google.maps.LatLngBounds;for(var t=0;t<a.length;t++)e.extend(a[t].getPosition());u.fitBounds(e)}var r=n.getUserLocation({returnLatLng:!0},function(e){var n=t.getStores({lat:e.lat,lng:e.lng,radius:500}).then(function(t){i(e);h(t)})})}}});