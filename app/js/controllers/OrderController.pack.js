"use strict";pizzaApp.controller("OrderController",function(t,n,r,i){t.order={vendor:"",customerId:0,items:[{id:1,count:0,type:"",size:""}]};t.master={vendor:"",customerId:0,items:[{id:1,count:0,type:"",size:""}]};t.reset=function(){t.order=angular.copy(t.master)};t.allOrders=function(){n.getAllOrders().$promise.then(function(e){console.log("success",e)}).catch(function(e){console.log("failure",e)})};t.saveOrder=function(e,i){var s;n.getNextId(function(s){e.id=s[0];r.info("order.id: "+e.id);i.$valid&&n.save(e).$promise.then(function(n){console.log("success",n);t.id=e.id}).catch(function(e){console.log("failure",e)})})};t.updateOrder=function(e,t){r.info("items : "+e.items);r.info("vendor : "+e.vendor);r.info("newOrderForm : "+t);var i;e.id=9999;n.getNextId(function(i){e.id=i[0];r.info("order.id: "+e.id);t.$valid&&n.save(e).$promise.then(function(e){console.log("success",e)}).catch(function(e){console.log("failure",e)})})};var s=function(e,n){r.info("old val: "+n+" new val: "+e);if(e!=n){r.info("id: "+t.id);if(t.id){r.info("id exists");t.updateOrder(t.order,newOrderForm)}else{r.info("no id exists");t.saveOrder(t.order,newOrderForm)}}};t.$watch("order.vendor",s);t.$watch("order.items.length",s);t.addItem=function(e){var n=t.order.items,r=n.length+1;n.push({id:r,type:"",size:""})};t.removeItem=function(e){var n=t.order.items,r=e.id-1;if(r>=0){n.splice(r,1);var i=1;for(var s in n){n[s].id=i;i++}}}});